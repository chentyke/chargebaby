# 充电宝产品数据提交系统设计文档

## 概述

基于充电宝产品数据提交页面设计草稿，我们重新设计了完整的提交系统，包含10个步骤的详细数据收集流程，以及配套的Notion数据库结构。

## 系统架构

### 1. 前端组件结构

```
src/
├── app/submit/page.tsx                    # 主提交页面（欢迎页+路由）
├── components/
│   ├── chargebaby-submission-form.tsx    # 完整的10步骤表单组件
│   └── ui/back-button.tsx               # 更新后的返回按钮组件
└── api/submit/route.ts                   # 提交API路由（已存在）
```

### 2. 数据流程

1. **欢迎页** → 用户阅读说明并同意协议
2. **10步骤表单** → 详细数据收集
3. **API提交** → 数据转换并存储到Notion
4. **完成页** → 提交确认

## 设计草稿对应的功能实现

### 步骤1：欢迎页
- ✅ 数据收集协议说明
- ✅ 测试流程参考指南提示
- ✅ 草稿功能说明
- ✅ 协议同意checkbox
- ✅ 开始按钮

### 步骤2：产品基础信息
- ✅ 移动电源名称（对应数据库：Title）
- ✅ 品牌
- ✅ 型号
- ✅ 容量级别（mAh）

### 步骤3：物理规格
- ✅ 长度、宽度、厚度、重量
- ✅ 线缆长度（单选）
- ✅ 线缆柔软度（单选）

### 步骤4：性能数据：自充电
- ✅ 自充电时长（min）
- ✅ 自充能量（Wh）
- ✅ 20分钟充入能量（Wh）

### 步骤5：性能数据：输出
- ✅ 最大持续输出平均功率（W）
- ✅ 最大放电容量（Wh）

### 步骤6：性能数据：温度与纹波
- ✅ 表面最高温度（单选）
- ✅ 温度均匀性（单选）
- ✅ 温控策略（多选）
- ✅ 最大纹波（单选）

### 步骤7：协议支持性
- ✅ PD固定档支持性（多选）
- ✅ PD PPS支持性（动态添加）
- ✅ PD AVS支持性（预留）
- ✅ QC支持性（多选）
- ✅ UFCS支持性（预留）
- ✅ 私有协议支持性（预留）
- ✅ 潜在协议冲突（预留）

### 步骤8：多接口使用
- ✅ 双接口同时输出能力（单选）
- ✅ 双接口边冲边放（单选）
- ✅ 双接口"不断联"能力（多选）

### 步骤9：信息显示与其他功能
- ✅ 显示内容（多选）
- ✅ 显示载体（单选）
- ✅ 显示亮度（单选）
- ✅ 显示自定义能力（预留）
- ✅ 接口输入输出方向自定义（预留）
- ✅ IoT能力（多选）

### 步骤10：产品评价与个人信息
- ✅ 产品优点（文本）
- ✅ 产品缺点（文本）
- ✅ 投稿人昵称
- ✅ 联系方式（可选）
- ✅ 其他问题或建议（文本）

### 步骤11：完成页
- ✅ 提交成功确认
- ✅ 感谢信息

## 数据库结构

### Notion数据库字段映射

| 表单字段 | Notion字段名 | 字段类型 | 说明 |
|---------|-------------|----------|------|
| 产品名称 | Title | Rich Text | 主要标题 |
| 品牌 | 品牌 | Rich Text | 品牌信息 |
| 型号 | Model | Title | 数据库标题字段 |
| 容量级别 | 容量级别（mAh） | Number | 数值 |
| 长度 | 长度（cm） | Number | 数值 |
| 宽度 | 宽度（cm） | Number | 数值 |
| 厚度 | 厚度（cm） | Number | 数值 |
| 重量 | 重量（g） | Number | 数值 |
| 线缆长度 | 线缆长度 | Select | 单选 |
| 线缆柔软度 | 线缆柔软度 | Select | 单选 |
| 自充时间 | 自充时间（min） | Number | 数值 |
| 自充能量 | 自充能量（Wh） | Number | 数值 |
| 20分钟能量 | 20分钟充入能量（Wh） | Number | 数值 |
| 最大持续输出功率 | 最大持续输出平均功率（W） | Number | 数值 |
| 最大放电容量 | 最大放电容量（Wh） | Number | 数值 |
| 表面最高温度 | 表面最高温度 | Select | 单选 |
| 温度均匀性 | 温度均匀性 | Select | 单选 |
| 温控策略 | 温控策略 | Multi-select | 多选 |
| 最大纹波 | 最大纹波 | Select | 单选 |
| PD固定档支持 | PD固定档支持 | Multi-select | 多选 |
| PD PPS支持 | PD_PPS支持 | Rich Text | 文本列表 |
| QC支持 | QC支持 | Multi-select | 多选 |
| 双接口输出能力 | 双接口输出能力 | Select | 单选 |
| 双接口边冲边放 | 双接口边冲边放 | Select | 单选 |
| 显示内容 | 显示内容 | Multi-select | 多选 |
| 显示载体 | 显示载体 | Select | 单选 |
| 显示亮度 | 显示亮度 | Select | 单选 |
| IoT能力 | IoT能力 | Multi-select | 多选 |
| 产品优点 | 产品优点 | Rich Text | 长文本 |
| 产品缺点 | 产品缺点 | Rich Text | 长文本 |
| 投稿人信息 | 数据来源 | Rich Text | 包含完整信息 |
| 提交时间 | 提交时间 | Date | 自动时间戳 |

## 示例数据文件

`notion-database-sample.csv` 包含5个示例产品的完整数据，可用于：

1. **初始化Notion数据库**：导入CSV创建数据库结构
2. **测试数据验证**：确保字段类型和格式正确
3. **参考标准**：为用户提供填写示例

### 示例产品包括：
- 小米自带线充电宝 10000 67W
- 安克 PowerCore 20000
- 华为SuperCharge 快充移动电源
- 紫米 10号移动电源
- OPPO SuperVOOC 移动电源

## 部署说明

### 环境变量配置

```env
NOTION_API_KEY=your_notion_api_key
NOTION_SUBMISSION_DATABASE_ID=your_submission_database_id
NOTION_VERSION=2022-06-28
```

### Notion数据库创建步骤

1. 在Notion中创建新数据库
2. 导入 `notion-database-sample.csv` 创建初始结构
3. 根据字段映射表调整字段类型
4. 复制数据库ID到环境变量

### 部署验证

1. 访问 `/submit` 页面
2. 完成完整表单填写流程
3. 检查Notion数据库是否正确接收数据
4. 验证所有字段映射是否正确

## 特性说明

### 用户体验优化
- **进度指示器**：显示当前步骤和完成百分比
- **表单验证**：关键字段的实时验证
- **数据持久化**：表单数据在步骤间保持
- **响应式设计**：适配移动端和桌面端

### 数据完整性
- **必填字段验证**：确保关键信息不缺失
- **数据格式验证**：数值范围和格式检查
- **错误处理**：网络错误和API错误的友好提示

### 扩展性设计
- **模块化组件**：易于添加新的表单步骤
- **灵活的数据结构**：支持字段的增减和修改
- **API兼容性**：与现有系统API保持兼容

## 技术栈

- **前端**：Next.js 14, React, TypeScript, Tailwind CSS
- **后端**：Next.js API Routes
- **数据库**：Notion API
- **状态管理**：React useState
- **表单处理**：原生HTML表单 + 自定义验证

## 维护说明

### 添加新字段
1. 在 `ChargeBabySubmissionData` 接口中添加字段
2. 在对应步骤的 `renderStepContent` 中添加表单控件
3. 在 `handleSubmit` 中添加数据映射
4. 更新Notion数据库结构

### 修改验证规则
1. 在 `validateStep` 函数中添加验证逻辑
2. 在对应的表单控件中添加错误显示

### 更新样式
1. 使用Tailwind CSS类进行样式调整
2. 保持与现有设计系统的一致性

## 未来改进计划

1. **草稿保存功能**：本地存储未完成的表单数据
2. **图片上传**：支持产品图片直接上传
3. **批量导入**：支持CSV格式的批量数据导入
4. **数据可视化**：提交数据的图表分析
5. **审核工作流**：管理员审核机制
6. **API文档**：完整的API文档和SDK

---

此系统完全基于设计草稿实现，提供了完整的数据收集流程和灵活的扩展能力，可以满足充电宝产品数据库的各种需求。